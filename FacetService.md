**note:** this page is automatically generated from embedded documentation in the PHP source.

# Overview #

Represents a store's facet service.

You use it in the usual way. Either indirectly via the Store:

```php

$store = new Store("http://api.talis.com/stores/mystore");
$fs = $store->get_facet_service();
```

Or directly if you know its URI:

```php

$fs = new FacetService("http://api.talis.com/stores/mystore/service/facet");
```

Using the FacetService class is pretty simple: just call the facets method passing in the query, an array of fields to facet on and optionally the number of terms to return for each facet. As usual this method returns an HttpResponse:

```php

$response = $fs->facets('query', array('field1','field2'));
if ($response->is_success()) {
// do something useful
}
else {
// mummy...
}
```

You can parse the XML response using the parse\_facet\_xml method which returns a nested array of data representing the facet data:

```php

array (
'field1' => array (
0 => array ( 'value' => 'term1', 'number' => '5' ),
1 => array ( 'value' => 'term2', 'number' => '4' ),
1 => array ( 'value' => 'term3', 'number' => '2' ),
),
'field2' => array (
0 => array ( 'value' => 'term4', 'number' => '5' ),
1 => array ( 'value' => 'term5', 'number' => '4' ),
1 => array ( 'value' => 'term6', 'number' => '2' ),
),
)
```

If you like living dangerously then you can combine both the previous steps into one using facets\_to\_array. If an error occurs this method simply returns an empty array:

```php

$facets = $fs->facets_to_array('query', array('field1','field2'));
```

<dl>
<dt>See:</dt>
<dd><a href='http://n2.talis.com/wiki/Facet_Service'>http://n2.talis.com/wiki/Facet_Service</a></dd>
</dl>
## Constructors ##
  * [FacetService](#FacetService.md) - Create a new instance of this class
## Methods ##
  * [facets](#facets.md) - Perform a facet query
  * [facets\_to\_array](#facets_to_array.md) - Perform a facet query and return the results as an array.
  * [make\_facet\_uri](#make_facet_uri.md)
  * [parse\_facet\_xml](#parse_facet_xml.md) - Parse the response from a facet query into an array.

# Constructor Detail #

## FacetService ##

```
public FacetService(mixed uri, mixed credentials, mixed request_factory)
```

Create a new instance of this class<dl>
<dt>Param:</dt>
<dd>string uri URI of the facet service</dd>
<dd>Credentials credentials the credentials to use for authenticated requests (optional)</dd>
</dl>


# Method Detail #

## facets ##

```
public void facets(mixed query, mixed fields, mixed top)
```

Perform a facet query<dl>
<dt>Param:</dt>
<dd>string query the query to execute</dd>
<dd>array fields the list of fields to facet on</dd>
<dd>in top the number of facet results to return</dd>
<dt>Return:</dt>
<dd>HttpResponse</dd>
</dl>


## facets\_to\_array ##

```
public void facets_to_array(mixed query, mixed fields, mixed top)
```

Perform a facet query and return the results as an array. An empty array is returned if there are any HTTP errors.<dl>
<dt>Param:</dt>
<dd>string query the query to execute</dd>
<dd>array fields the list of fields to facet on</dd>
<dd>in top the number of facet results to return</dd>
<dt>Return:</dt>
<dd>array see parse_facet_xml for the structure of this array</dd>
</dl>


## make\_facet\_uri ##

```
public void make_facet_uri(mixed query, mixed fields, mixed top)
```



## parse\_facet\_xml ##

```
public void parse_facet_xml(mixed xml)
```

Parse the response from a facet query into an array.
This method returns an associative array where the keys correspond to field name and the values are
associative arrays with two keys:
<ul>
<li><em>value</em> => the value of the field</li>
<li><em>number</em> => the associated number returned by the facet service</li>
</ul><dl>
<dt>Param:</dt>
<dd>string xml the facet response as an XML document</dd>
<dt>Return:</dt>
<dd>array</dd>
</dl>




Generated by [PHPDoctor 2RC2](http://phpdoctor.sourceforge.net/)